C51 COMPILER V9.59.0.0   MAIN                                                              01/06/2019 01:03:07 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Project_Volter) DEBUG OBJECTEX
                    -TEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2            param[6]=1--->Sin
   3            param[6]=2--->Square Wave
   4          */
   5          
   6          #include "DISP.h"
   7          #include "I2C.h"
   8          #include "Func.h"
   9          #define uchar unsigned char
  10          #define uint unsigned int
  11          
  12          sbit recout=P1^0;
  13          
  14          bit erflags;
  15          bit setup;
  16          bit selectwp;
  17          bit rise;
  18          bit setupend;
  19          
  20          data uchar  param[9]={0x55,50,20,0,50,50,1};
  21          data uchar  p;
  22          data uchar  hide;
  23          data uchar  k;
  24          data uint   para1,para2;
  25          data uchar  da;
  26          data uchar  so;
  27          
  28          extern uchar disp[8];
  29          extern d2;
  30          
  31          int main()
  32          {
  33   1        int keynum;
  34   1        EA=1;
  35   1        ET0=1;
  36   1        ET1=1;
  37   1        PT0=1;
  38   1        PT1=0;
  39   1        TH0=(65536-500)/256;
  40   1        TL0=(65536-500)%256;
  41   1        TR0=1;
  42   1        TR1=1;
  43   1        read24c02();
  44   1        display(0,15);
  45   1        disp[1]=param[6];
  46   1        setup=0;
  47   1        while(1)
  48   1        {
  49   2          keynum=keyscan();
  50   2          if(keynum==12)
  51   2          {
  52   3            if(setup==1)
  53   3            {
  54   4              if(setupend==1)
C51 COMPILER V9.59.0.0   MAIN                                                              01/06/2019 01:03:07 PAGE 2   

  55   4              {
  56   5                write24c02;
*** WARNING C275 IN LINE 56 OF main.c: expression with possibly no effect
  57   5                Calculate();
  58   5                display(0,15);
  59   5                k=99;                           //no blink
  60   5              }
  61   4            }
  62   3            else
  63   3            {
  64   4              setup=1;
  65   4              disp[1]=param[6];
  66   4              display(5,15);
  67   4              selectwp=1;
  68   4              k=1;
  69   4            }
  70   3          }
  71   2          if(keynum==13)
  72   2          {
  73   3            if(selectwp==1)
  74   3            {
  75   4              switch(param[6])
  76   4              {
  77   5                case(1):param[6]=2;break;
  78   5                case(2):param[6]=1;break;
  79   5              }
  80   4            }
  81   3            else
  82   3            {
  83   4              k=1;
  84   4              disp[k]=1;
  85   4              display(5,15);
  86   4            }
  87   3          }
  88   2          if(keynum==14)
  89   2          {
  90   3            if(setup==1)
  91   3            {
  92   4              if(d2!=15)
  93   4                d2=15;
  94   4              else
  95   4                d2=10;
  96   4              if(keynum==110)
  97   4              {
  98   5                if(param[6]==1&&k>6)
  99   5                  k=k-1;
 100   5                else if(param[6]==2&&k>4)                     //What if in Vpp mode?
 101   5                  k=k-1;
 102   5              }
 103   4              if(keynum==120)
 104   4              {
 105   5                if(param[6]==1)
 106   5                {
 107   6                  if(k<6)
 108   6                    k=6;
 109   6                  else if(disp[6]==5)
 110   6                    k=6;
 111   6                  else if(k==7)
 112   6                    k=6;
 113   6                  else
 114   6                    k=k+1;
 115   6                }
C51 COMPILER V9.59.0.0   MAIN                                                              01/06/2019 01:03:07 PAGE 3   

 116   5                else if(param[6]==2)                          //What if in Vpp mode?
 117   5                {
 118   6                  if(k<4)
 119   6                    k=4;
 120   6                  else if(disp[4]==1)
 121   6                    k=4;
 122   6                  else if(k==7)
 123   6                    k=4;
 124   6                  else
 125   6                    k=k+1;
 126   6                }
 127   5              }
 128   4              if(keynum>=0&&keynum<=8)
 129   4              {
 130   5                NumProcess(keynum);
 131   5              }
 132   4              if(keynum==16)
 133   4              {
 134   5                setupend=1;
 135   5                ParamProcess();
 136   5              }
 137   4            }
 138   3            else
 139   3            {
 140   4              setup=1;
 141   4            }
 142   3          }
 143   2          if(keynum==15)  
 144   2          {
 145   3            if(disp[1]!=param[6])
 146   3              {
 147   4                if(param[6]==1) 
 148   4                  Stop();
 149   4                param[6]=disp[1];
 150   4                EA=0;
 151   4                write24c02();
 152   4                display(0,15);
 153   4                Calculate();
 154   4                EA=1;
 155   4              }
 156   3          }
 157   2        }
 158   1        return 0;
 159   1      }
 160          
 161          
 162          void output(void) interrupt 3
 163          {
 164   1        
 165   1        TR1=0;
 166   1        if(param[6]==1)
 167   1        {
 168   2          TH1=para1/256;
 169   2          TL1=para1%256;
 170   2          if(rise)
 171   2          {
 172   3            if(da<240)
 173   3            {
 174   4              da=da+16;
 175   4            }
 176   3            else if(da==240)
 177   3            {
C51 COMPILER V9.59.0.0   MAIN                                                              01/06/2019 01:03:07 PAGE 4   

 178   4              da=255;
 179   4              rise=0;
 180   4            }
 181   3          }
 182   2          else
 183   2          {
 184   3            if(da>16)
 185   3            {
 186   4              da=da-16;
 187   4            }
 188   3            else
 189   3            {
 190   4              da=0;
 191   4              rise=1;
 192   4            }
 193   3          }
 194   2          so=para2*da/50;
 195   2          /*Add I2C DAC Code*/
 196   2          sen:  erflags=0;              
 197   2            Start( );               
 198   2            SendByte(0x90);         
 199   2            cAck( );              
 200   2            if(erflags==1) goto sen;      
 201   2            SendByte(0x00);           
 202   2            cAck( );              
 203   2            if(erflags==1) goto sen;
 204   2            SendByte(0xa1);
 205   2            cAck(); 
 206   2            if(erflags==1) goto sen;    
 207   2          SendByte(so);
 208   2          cAck();
 209   2        }
 210   1        else if(param[6]==2)
 211   1        {
 212   2          recout=~recout;
 213   2          if(recout)  
 214   2          {
 215   3            TH1=para1/256;
 216   3            TL1=para1%256; 
 217   3          }
 218   2          else     
 219   2          {
 220   3            TH1=para2/256;
 221   3            TL1=para2%256; 
 222   3          }
 223   2        }
 224   1        TR1=1;
 225   1      }
*** WARNING C294 IN LINE 158 OF main.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    657    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     18       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      5    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
