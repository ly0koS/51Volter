C51 COMPILER V9.59.0.0   MAIN                                                              01/13/2019 01:09:21 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Project_Volter) DEBUG OBJECTEX
                    -TEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2            param[6]=1--->An Wave
   3            param[6]=2--->Square Wave
   4          */
   5          
   6          #include "DISP.h"
   7          #include "IIC.h"
   8          #include "Func.h"
   9          #define uchar unsigned char
  10          #define uint unsigned int
  11          
  12          sbit recout=P1^0;
  13          
  14          
  15          bit erflags;
  16          bit setup;
  17          bit selectwp;
  18          bit rise;
  19          bit setupend;
  20          
  21          data uchar  param[9]={0x55,25,50,0,50,50,1};
  22          data uchar  k;
  23          data uint   para1 _at_ 0x10;
  24          data uint   para2 _at_ 0x11;
  25          data uchar  da;
  26          data uchar  so;
  27          data uint keynum _at_ 0x50;
  28          
  29          extern uchar disp[8];
  30          extern uchar d2;
  31          extern uchar hide;
  32          extern uchar i;
  33          
  34          int main()
  35          {
  36   1        EA=1;
  37   1        ET0=1;
  38   1        ET1=1;
  39   1        TMOD=0x11;
  40   1        TH0=(65536-500)/256;
  41   1        TL0=(65536-500)%256;
  42   1        TR0=1;
  43   1        TR1=1;
  44   1        read24c02();
  45   1        Calculate();
  46   1        disp[1]=param[6];
  47   1        display(0,15);
  48   1        while(1)
  49   1        {
  50   2          keynum=keyscan();
  51   2          if(setup==1)                      //Setup Mode
  52   2          {
  53   3            if(keynum==12)                //setting
  54   3            {
C51 COMPILER V9.59.0.0   MAIN                                                              01/13/2019 01:09:21 PAGE 2   

  55   4              setup=0;
  56   4              if(setupend==1)
  57   4              {
  58   5                setupend=0;
  59   5                EA=0;
  60   5                write24c02();
  61   5                Calculate();
  62   5                EA=1;
  63   5                k=255;
  64   5              }
  65   4              disp[1]=param[6];
  66   4              display(0,15);
  67   4              keynum=255;
  68   4            }
  69   3            if(keynum==13)                //select wave
  70   3            {
  71   4              if(selectwp==1)
  72   4              {
  73   5                switch(param[6])
  74   5                {
  75   6                  case(1):disp[1]=2;break;
  76   6                  case(2):disp[1]=1;break;
  77   6                }
  78   5              }
  79   4              else
  80   4              {
  81   5                selectwp=1;
  82   5                k=1;
  83   5                disp[1]=1;
  84   5              }
  85   4              display(5,15);
  86   4              keynum=255;
  87   4            }
  88   3            if(keynum==14)                //select param
  89   3            {
  90   4              k=2;
  91   4              if(selectwp==0)
  92   4              {
  93   5                if(disp[2]!=15)
  94   5                  display(5,15);
  95   5                else
  96   5                  display(5,10);
  97   5              }
  98   4              else
  99   4                selectwp=0;
 100   4              keynum=255;
 101   4            }
 102   3            if(keynum==10)                //go left
 103   3            {
 104   4              if(selectwp==0)
 105   4              {
 106   5                if(disp[2]==15&&disp[1]==2)
 107   5                {
 108   6                  if(k>4)
 109   6                    k--;
 110   6                }
 111   5                else if(k>6)
 112   5                  k--;
 113   5              }
 114   4              keynum=255;
 115   4            }
 116   3            if(keynum==20)                //go right
C51 COMPILER V9.59.0.0   MAIN                                                              01/13/2019 01:09:21 PAGE 3   

 117   3            {
 118   4              if(selectwp==0)
 119   4              {
 120   5                if(k<7)
 121   5                  k++;
 122   5                if((disp[2]==15)&&(disp[1]==2))
 123   5                  {
 124   6                    if((k<4)||(disp[4]==1))
 125   6                      k=4;
 126   6                  }
 127   5                  else 
 128   5                  {
 129   6                    if(k<6)
 130   6                      k=6;
 131   6                    if ((disp[2]!=13)&&(disp[6]==5))
 132   6                      k=6;
 133   6                    if ((disp[2]==13)&&(disp[6]==8))
 134   6                      k=6;
 135   6                  }     
 136   5              }
 137   4              keynum=255;
 138   4            }
 139   3            if(keynum==15)                //confim
 140   3            {
 141   4              setupend=1;
 142   4              ParamProcess();
 143   4              keynum=255;
 144   4            }
 145   3            else if(keynum<=9&&keynum>=0)
 146   3            {
 147   4              NumProcess(keynum);
 148   4              keynum=255;
 149   4            }
 150   3          }
 151   2          else                          //Not in Setup Mode
 152   2          {
 153   3            k=255;
 154   3            if(keynum==12)
 155   3            {
 156   4              setup=1;
 157   4              disp[1]=param[6];
 158   4              display(5,15);
 159   4              selectwp=1; 
 160   4              k=1;
 161   4              keynum=255;
 162   4            }
 163   3            if(keynum==13)
 164   3            {
 165   4              disp[1]=disp[1]+1; 
 166   4              if(disp[1]>=3) 
 167   4                disp[1]=1;
 168   4              display(0,15);
 169   4              keynum=255;
 170   4            }
 171   3            if(keynum==14)
 172   3            {             
 173   4              if(disp[2]!=15) 
 174   4                display(0,15);
 175   4              else    
 176   4                display(0,10);
 177   4              keynum=255;
 178   4            }
C51 COMPILER V9.59.0.0   MAIN                                                              01/13/2019 01:09:21 PAGE 4   

 179   3            if(keynum==15)  
 180   3            {
 181   4              if(disp[1]!=param[6])
 182   4              {
 183   5                if(param[6]==1) 
 184   5                  Stop();
 185   5                param[6]=disp[1];
 186   5                EA=0;
 187   5                write24c02();
 188   5                display(0,15);
 189   5                Calculate();
 190   5                EA=1;
 191   5              }
 192   4              keynum=255;
 193   4            }
 194   3          }
 195   2        }
 196   1        return 0;
 197   1      }
 198          
 199          
 200          void output(void) interrupt 3
 201          {
 202   1        TR1=0;
 203   1        if(param[6]==1)
 204   1        {
 205   2          TH1=para1/256;
 206   2          TL1=para1%256;
 207   2          if(rise) 
 208   2          {   
 209   3            if(da<=239) da=da+16;
 210   3            else {rise=0; da=255;}
 211   3          }
 212   2          else 
 213   2          {   
 214   3            if(da>=17)  da=da-16;
 215   3            else {rise=1; da=0;}
 216   3          }
 217   2          so=para2*da/50;
 218   2          /*Add I2C DAC Code*/
 219   2          SendByte(so);
 220   2          cAck();
 221   2        }
 222   1        else if(param[6]==2)
 223   1        {
 224   2          recout=~recout;
 225   2          if(recout)  
 226   2          {
 227   3            TH1=para1/256;
 228   3            TL1=para1%256; 
 229   3          }
 230   2          else     
 231   2          {
 232   3            TH1=para2/256;
 233   3            TL1=para2%256; 
 234   3          }
 235   2        }
 236   1        TR1=1;
 237   1      }
 238          
*** WARNING C294 IN LINE 196 OF main.c: unreachable code

C51 COMPILER V9.59.0.0   MAIN                                                              01/13/2019 01:09:21 PAGE 5   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    753    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      5    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
