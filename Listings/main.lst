C51 COMPILER V9.59.0.0   MAIN                                                              01/07/2019 17:42:56 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Project_Volter) DEBUG OBJECTEX
                    -TEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          /*
   2            param[6]=1--->Sin
   3            param[6]=2--->Square Wave
   4          */
   5          
   6          #include "DISP.h"
   7          #include "IIC.h"
   8          #include "Func.h"
   9          #define uchar unsigned char
  10          #define uint unsigned int
  11          
  12          sbit recout=P1^0;
  13          
  14          bit erflags;
  15          bit setup;
  16          bit selectwp;
  17          bit rise;
  18          bit setupend;
  19          
  20          data uchar  param[9]={0x55,50,20,0,50,50,2};
  21          data uchar  k;
  22          data uint   para1,para2;
  23          data uchar  da;
  24          data uchar  so;
  25          
  26          extern uchar disp[8];
  27          extern uchar d2;
  28          
  29          int main()
  30          {
  31   1        int keynum;
  32   1        EA=1;
  33   1        ET0=1;
  34   1        ET1=1;
  35   1        PT0=1;
  36   1        PT1=0;
  37   1        TH0=(65536-500)/256;
  38   1        TL0=(65536-500)%256;
  39   1        TR0=1;
  40   1        TR1=1;
  41   1        read24c02();
  42   1        Calculate();
  43   1        display(0,15);
  44   1        disp[1]=param[6];
  45   1        setup=0;
  46   1        while(1)
  47   1        {
  48   2          keynum=keyscan();
  49   2          if(setup==1)                      //Setup Mode
  50   2          {
  51   3            if(keynum==12)                //setting
  52   3            {
  53   4              setup=0;
  54   4              if(setupend==1)
C51 COMPILER V9.59.0.0   MAIN                                                              01/07/2019 17:42:56 PAGE 2   

  55   4              {
  56   5                setupend=0;
  57   5                write24c02();
  58   5                Calculate();
  59   5                k=99;
  60   5              }
  61   4              disp[1]=param[6];
  62   4              display(0,15);
  63   4            }
  64   3            if(keynum==13)                //select wave
  65   3            {
  66   4              if(selectwp==1)
  67   4              {
  68   5                switch(param[6])
  69   5                {
  70   6                  case(1):param[6]=2;break;
  71   6                  case(2):param[6]=1;break;
  72   6                }
  73   5                display(5,15);
  74   5              }
  75   4              else
  76   4              {
  77   5                selectwp=1;
  78   5                k=1;
  79   5                disp[1]=1;
  80   5              }
  81   4              display(5,15);
  82   4            }
  83   3            if(keynum==14)                //select param
  84   3            {
  85   4              k=2;
  86   4              if(selectwp==0)
  87   4              {
  88   5                if(disp[2]!=15)
  89   5                  display(5,15);
  90   5                else
  91   5                  display(5,10);
  92   5              }
  93   4              else
  94   4                selectwp=0;
  95   4            }
  96   3            if(keynum==10)                //go left
  97   3            {
  98   4              if(selectwp==0)
  99   4              {
 100   5                if(disp[2]==15&&disp[1]==2)
 101   5                {
 102   6                  if(k>4)
 103   6                    k--;
 104   6                }
 105   5                else if(k>6)
 106   5                  k--;
 107   5              }
 108   4            }
 109   3            if(keynum==20)                //go right
 110   3            {
 111   4              if(selectwp==0)
 112   4              {
 113   5                if(disp[2]==15&&disp[1]==2)
 114   5                {
 115   6                  if(k<=4)
 116   6                    k=4;
C51 COMPILER V9.59.0.0   MAIN                                                              01/07/2019 17:42:56 PAGE 3   

 117   6                  else if(disp[4]==1)
 118   6                    k=4;
 119   6                }
 120   5                else if(k<=6)
 121   5                  k=6;
 122   5                else if(param[6]==1&&disp[2]==10&&disp[6]==5)
 123   5                  k=6;
 124   5                else
 125   5                  k++;
 126   5              }
 127   4            }
 128   3            if(keynum==15)                //confim
 129   3            {
 130   4              setupend=1;
 131   4              ParamProcess();
 132   4            }
 133   3            else if(keynum<=9&&keynum>=0)
 134   3            {
 135   4              NumProcess(keynum);
 136   4            }
 137   3          }
 138   2          else if(setup==0)                         //Not in Setup Mode
 139   2          {
 140   3            if(keynum==12)
 141   3            {
 142   4              setup=1;
 143   4              disp[1]=param[6];
 144   4              display(5,15);
 145   4              selectwp=1; 
 146   4              k=1;
 147   4            }
 148   3            if(keynum==13)
 149   3            {
 150   4              disp[1]=disp[1]+1; 
 151   4              if(disp[1]>=3) 
 152   4                disp[1]=1;
 153   4              display(0,15);
 154   4            }
 155   3            if(keynum==14)
 156   3            {             
 157   4              if(disp[2]!=15) 
 158   4                display(0,15);
 159   4              else    
 160   4                display(0,10);
 161   4            }
 162   3            if(keynum==15)  
 163   3            {
 164   4            if(disp[1]!=param[6])
 165   4              {
 166   5                if(param[6]==1) 
 167   5                  Stop();
 168   5                param[6]=disp[1];
 169   5                EA=0;
 170   5                write24c02();
 171   5                display(0,15);
 172   5                Calculate();
 173   5                EA=1;
 174   5              }
 175   4            }
 176   3          }
 177   2        }
 178   1        return 0;
C51 COMPILER V9.59.0.0   MAIN                                                              01/07/2019 17:42:56 PAGE 4   

 179   1      }
 180          
 181          
 182          void output(void) interrupt 3
 183          {
 184   1        
 185   1        TR1=0;
 186   1        if(param[6]==1)
 187   1        {
 188   2          TH1=para1/256;
 189   2          TL1=para1%256;
 190   2          if(rise)
 191   2          {
 192   3            if(da<240)
 193   3            {
 194   4              da=da+16;
 195   4            }
 196   3            else if(da==240)
 197   3            {
 198   4              da=255;
 199   4              rise=0;
 200   4            }
 201   3          }
 202   2          else
 203   2          {
 204   3            if(da>16)
 205   3            {
 206   4              da=da-16;
 207   4            }
 208   3            else
 209   3            {
 210   4              da=0;
 211   4              rise=1;
 212   4            }
 213   3          }
 214   2          so=para2*da/50;
 215   2          /*Add I2C DAC Code*/
 216   2          sen:  erflags=0;              
 217   2            Start( );               
 218   2            SendByte(0x90);         
 219   2            cAck( );              
 220   2            if(erflags==1) goto sen;      
 221   2            SendByte(0x00);           
 222   2            cAck( );              
 223   2            if(erflags==1) goto sen;
 224   2            SendByte(0x91);
 225   2            cAck(); 
 226   2            if(erflags==1) goto sen;
 227   2      
 228   2          SendByte(so);
 229   2          cAck();
 230   2        }
 231   1        else if(param[6]==2)
 232   1        {
 233   2      //    Calculate();
 234   2          recout=~recout;
 235   2          if(recout)  
 236   2          {
 237   3            TH1=para1/256;
 238   3            TL1=para1%256; 
 239   3          }
 240   2          else     
C51 COMPILER V9.59.0.0   MAIN                                                              01/07/2019 17:42:56 PAGE 5   

 241   2          {
 242   3            TH1=para2/256;
 243   3            TL1=para2%256; 
 244   3          }
 245   2        }
 246   1        TR1=1;
 247   1      }
*** WARNING C294 IN LINE 178 OF main.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    749    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     16       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      5    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
